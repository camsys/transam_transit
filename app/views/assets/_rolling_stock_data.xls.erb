<% @assets.each do |a| %>
  <Row>
    <Cell><Data ss:Type="String"><%= a.object_key %></Data></Cell>
    <Cell><Data ss:Type="String"><%= a.asset_type.name %></Data></Cell>
    <Cell><Data ss:Type="String"><%= a.asset_subtype.name %></Data></Cell>
    <Cell><Data ss:Type="String"><%= a.asset_tag %></Data></Cell>
    <Cell><Data ss:Type="String"><%= a.service_status_type.nil? ? 'Unknown' : a.service_status_type.name %></Data></Cell>
    <Cell><Data ss:Type="Number"><%= a.age %></Data></Cell>

    <Cell><Data ss:Type="String"><%= a.policy_replacement_year %></Data></Cell>
    <Cell><Data ss:Type="String"><%= format_as_currency(a.estimated_value) %></Data></Cell>
    <Cell><Data ss:Type="String"><%= a.estimated_replacement_year %></Data></Cell>
    <Cell><Data ss:Type="String"><%= format_as_currency(a.estimated_replacement_cost) %></Data></Cell>
    <Cell><Data ss:Type="String"><%= a.in_backlog.nil? ? 'No' : 'Yes' %></Data></Cell>

    <Cell><Data ss:Type="String"><%= a.reported_condition_type.nil? ? 'Unknown' : a.reported_condition_type.name %></Data></Cell>
    <Cell><Data ss:Type="String"><%= format_as_date(a.reported_condition_date)  %></Data></Cell>
    <Cell><Data ss:Type="String"><%= a.estimated_condition_type.nil? ? 'Unknown' : a.estimated_condition_type.name  %></Data></Cell>

    <Cell><Data ss:Type="String"><%= a.manufacturer.name %></Data></Cell>
    <Cell><Data ss:Type="String"><%= a.manufacturer_model  %></Data></Cell>
    <Cell><Data ss:Type="Number"><%= a.manufacture_year %></Data></Cell>
    <Cell><Data ss:Type="Number"><%= a.vehicle_length %></Data></Cell>

    <Cell><Data ss:Type="String"><%= a.title_owner.name %></Data></Cell>
    <Cell><Data ss:Type="String"><%= a.purchased_new ? 'Yes' : 'No' %></Data></Cell>
    <Cell><Data ss:Type="String"><%= format_as_currency(a.purchase_cost) %></Data></Cell>
    <Cell><Data ss:Type="String"><%= format_as_date(a.purchase_date) %></Data></Cell>

    <Cell><Data ss:Type="Number"><%= a.expected_useful_life %></Data></Cell>
    <Cell><Data ss:Type="String"><%= format_as_percentage(a.pcnt_federal_funding) %></Data></Cell>
    <Cell><Data ss:Type="String"><%= a.vin %></Data></Cell>
    <Cell><Data ss:Type="String"><%= a.rebuild_year %></Data></Cell>

    <Cell><Data ss:Type="String"><%= a.fta_funding_source_type.nil? ? 'Unknown' : a.fta_funding_source_type %></Data></Cell>
    <Cell><Data ss:Type="String"><%= a.description %></Data></Cell>


    <Cell><Data ss:Type="String"><%= a.fta_ownership_type.code %></Data></Cell>

    <Cell><Data ss:Type="String"><%= a.ada_accessible_lift ? 'Yes' : 'No' %></Data></Cell>
    <Cell><Data ss:Type="String"><%= a.ada_accessible_ramp ? 'Yes' : 'No' %></Data></Cell>
    <Cell><Data ss:Type="String"><%= a.fta_emergency_contingency_fleet ? 'Yes' : 'No' %></Data></Cell>
    <Cell><Data ss:Type="String"><%= a.fta_mode_types.join(", ") %></Data></Cell>
    <Cell><Data ss:Type="String"><%= a.fta_service_types.join(", ") %></Data></Cell>

    <% if a.type_of?(:vehicle) || a.type_of?(:rail_car) %>
      <Cell><Data ss:Type="Number"><%= a.seating_capacity %></Data></Cell>
      <Cell><Data ss:Type="Number"><%= a.standing_capacity %></Data></Cell>
      <Cell><Data ss:Type="Number"><%= a.wheelchair_capacity %></Data></Cell>
      <Cell><Data ss:Type="String"><%= a.vehicle_features.join(", ") %></Data></Cell>

      <% if a.type_of?(:vehicle) %>
        <Cell><Data ss:Type="String"><%= a.fuel_type.name %></Data></Cell>
        <Cell><Data ss:Type="String"><%= format_as_integer(a.expected_useful_miles) %></Data></Cell>
        <Cell><Data ss:Type="String"><%= a.license_plate %></Data></Cell>
      <% end %>

    <% end %>

    <% if a.type_of?(:locomotive) %>
      <Cell><Data ss:Type="String"><%= a.fuel_type.name %></Data></Cell>
    <% end %>

    <% if a.type_of?(:support_vehicle) %>
      <Cell><Data ss:Type="String"><%= a.license_plate %></Data></Cell>
      <Cell><Data ss:Type="String"><%= a.seating_capacity %></Data></Cell>
      <Cell><Data ss:Type="String"><%= a.fuel_type.name %></Data></Cell>
    <% end %>

  </Row>
<% end %>
