<% is_transit_facility = @view.starts_with?('transit_facility') %>
<% is_support_facility = @view.starts_with?('support_facility') %>
<% is_structure = is_transit_facility || is_support_facility %>

<% @assets.each do |a| %>
  <Row>
    <Cell><Data ss:Type="String"><%= a.object_key %></Data></Cell>
    <Cell><Data ss:Type="String"><%= a.asset_type.name %></Data></Cell>
    <Cell><Data ss:Type="String"><%= a.asset_subtype.name %></Data></Cell>
    <Cell><Data ss:Type="String"><%= a.asset_tag %></Data></Cell>
    <Cell><Data ss:Type="String"><%= a.service_status_type.nil? ? 'Unknown' : a.service_status_type.name %></Data></Cell>
    <Cell><Data ss:Type="Number"><%= a.age %></Data></Cell>

    <Cell><Data ss:Type="String"><%= a.policy_replacement_year %></Data></Cell>
    <Cell><Data ss:Type="String"><%= format_as_currency(a.estimated_value) %></Data></Cell>
    <Cell><Data ss:Type="String"><%= a.estimated_replacement_year %></Data></Cell>
    <Cell><Data ss:Type="String"><%= format_as_currency(a.estimated_replacement_cost) %></Data></Cell>
    <Cell><Data ss:Type="String"><%= a.in_backlog.nil? ? 'No' : 'Yes' %></Data></Cell>

    <Cell><Data ss:Type="String"><%= a.reported_condition_type.nil? ? 'Unknown' : a.reported_condition_type.name %></Data></Cell>
    <Cell><Data ss:Type="String"><%= format_as_date(a.reported_condition_date)  %></Data></Cell>
    <Cell><Data ss:Type="String"><%= a.estimated_condition_type.nil? ? 'Unknown' : a.estimated_condition_type.name  %></Data></Cell>

    <Cell><Data ss:Type="String"><%= a.description %></Data></Cell>
    <Cell><Data ss:Type="String"><%= a.address1 %></Data></Cell>
    <Cell><Data ss:Type="String"><%= a.address2 %></Data></Cell>
    <Cell><Data ss:Type="String"><%= a.city %></Data></Cell>
    <Cell><Data ss:Type="String"><%= a.state %></Data></Cell>
    <Cell><Data ss:Type="Number"><%= a.zip %></Data></Cell>

    <Cell><Data ss:Type="String"><%= format_as_percentage(a.pcnt_operational) %></Data></Cell>
    <Cell><Data ss:Type="Number"><%= a.num_floors %></Data></Cell>

    <Cell><Data ss:Type="Number"><%= a.num_structures %></Data></Cell>
    <Cell><Data ss:Type="Number"><%= a.lot_size %></Data></Cell>
    <Cell><Data ss:Type="Number"><%= a.facility_size %></Data></Cell>
    <Cell><Data ss:Type="String"><%= format_as_currency(a.purchase_cost) %></Data></Cell>
    <Cell><Data ss:Type="String"><%= format_as_date(a.purchase_date) %></Data></Cell>

    <Cell><Data ss:Type="Number"><%= a.expected_useful_life %></Data></Cell>
    <Cell><Data ss:Type="String"><%= format_as_percentage(a.pcnt_federal_funding) %></Data></Cell>
    <Cell><Data ss:Type="String"><%= a.fta_funding_source_type.nil? ? 'Unknown' : a.fta_funding_source_type %></Data></Cell>
    <Cell><Data ss:Type="String"><%= a.ada_accessible_ramp ? 'Yes' : 'No' %></Data></Cell>

    <% if is_transit_facility %>
      <Cell><Data ss:Type="Number"><%= a.num_elevators %></Data></Cell>
      <Cell><Data ss:Type="Number"><%= a.num_escalators %></Data></Cell>
      <Cell><Data ss:Type="String"><%= a.facility_features.join(", ") %></Data></Cell>
      <Cell><Data ss:Type="String"><%= a.fta_mode_types.join(", ") %></Data></Cell>
    <% end %>

    <% if is_support_facility %>
      <Cell><Data ss:Type="String"><%= a.facility_capacity_type.name %></Data></Cell>
    <% end %>
  </Row>
<% end %>
