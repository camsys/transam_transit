%ul.nav.nav-tabs
  %li.active
    %a{:href => '#required', :data =>{:toggle => 'tab'}}
      Required Fields
  %li
    %a{:href => '#recommended', :data =>{:toggle => 'tab'}}
      Recommended Fields

= simple_form_for(@asset,
  :as => :asset,
  :url => inventory_index_path,
  :method => 'post',
  :html => {:class => 'form-vertical'},
  :wrapper => :vertical_form,
  :wrapper_mappings => {:check_boxes => :vertical_radio_and_checkboxes,
    :radio_buttons => :vertical_radio_and_checkboxes,
    :file => :vertical_file_input,
    :boolean => :vertical_boolean}) do |f|

  .tab-content.form-section
    .tab-pane.fade.in.active#required
      .col-sm-6
        
        %h2.form-section-header
          Organization

        = f.association :organization, collection: TransitOperator.where(id: @asset.organization_id)

        %h2.form-section-header
          Service Status

        = f.simple_fields_for :service_status_updates, @asset.service_status_updates.build do |update_event|
          = update_event.input :service_status_type_id, collection: ServiceStatusType.active, label: 'Service Status'

        %h2.form-section-header
          Identification & Classification

        = f.input :asset_tag, label: 'Asset ID'

        = f.input :fta_asset_category_id, as: :hidden, input_html: {value: @asset.fta_asset_class.fta_asset_category_id}
        = f.association :fta_asset_class, collection: FtaAssetClass.where(id: @asset.fta_asset_class_id), label: 'Class'
        
        = f.input :global_fta_type, :collection => FtaVehicleType.all.map{|f| [ f.to_s, f.to_global_id ]}, label: 'Type', required: true
        
        = f.association :asset_subtype, label: 'Subtype'
        
        = f.association :parent, :collection => Facility.where(organization_id: @organization_list), :label => 'Facility Name'

        .form-group.required
          %label.required.control-label
            %abbr{title: 'required'} *
            = "Facility Categorization"
          %span.radio
            %label
              = radio_button_tag :facility_category, 'component'
              Component (of Primary Facility)
          %span.radio
            %label
              = radio_button_tag :facility_category, 'sub_component'
              Sub-Component (of Primary Facility)

          = f.association :component_type, label: 'Type'
          = f.association :component_subtype, label: 'Type'

          = f.input :description

      .col-sm-6

        %h2.form-section-header
          Characteristics

        = f.input :manufacture_year, label: 'Year Built'


        %h2.form-section-header
          Funding

        = f.simple_fields_for :purchase_cost do |update_event|
          = update_event.input :purchase, :wrapper => :vertical_prepend, label: 'Cost (Purchase)' do
            %span.input-group-addon
              %i.fa.fa-usd
            = update_event.input_field :purchase_cost, :class => 'form-control', required: true, :value => 0, :label => false

        .form-group.required.radio-buttons-inline
          %label.required.control-label
            %abbr{title: 'required'} *
            = " Direct Capital Responsibility"
          %span.radio
            %label
              = radio_button_tag :direct_capital_responsibility, 'yes', @asset.direct_capital_responsibility
              Yes
          %span.radio
            %label
              = radio_button_tag :direct_capital_responsibility, 'no', !@asset.direct_capital_responsibility
              No

        %h2.form-section-header
          Operations

        = f.input :in_service_date, :wrapper => :vertical_append, :label => "In Service Date" do
          = f.input_field :in_service_date, :as => :string, :class => 'form-control datepicker', :value => format_as_date(f.object.in_service_date)
          %span.input-group-addon
            %i.fa.fa-calendar

        %h2.form-section-header
          Procurement & Purchase

        = f.input :purchased_new, as: :radio_buttons, required: true, :wrapper_class => 'form-group radio-buttons-inline'


    .tab-pane.fade.in#recommended
      .col-sm-6

      .col-sm-6

  %hr

  
  = f.input :asset_tag
  = f.input :external_id
  = f.input :fta_asset_category_id, as: :hidden, input_html: {value: @asset.fta_asset_class.fta_asset_category_id}
  = f.association :fta_asset_class
  = f.input :global_fta_type, :collection => FtaEquipmentType.all.map{|f| [ f.to_s, f.to_global_id ]}
  = f.association :asset_subtype
  

  

  = f.input :quantity
  = f.input :quantity_unit
  = f.association :serial_numbers

  = f.input :other_manufacturer
  = f.input :other_manufacturer_model
  = f.input :manufacture_year

  =# render :partial => "assets/accounting_asset_form", :locals => {:f => f}

  = f.input :purchase_cost
  = f.input :pcnt_capital_responsibility

  = f.input :purchased_new
  = f.input :purchase_date
  = f.input :contract_num
  = f.association :contract_type
  = f.association :vendor
  = f.input :other_vendor
  = f.input :has_warranty
  = f.input :warranty_date

  = f.input :in_service_date

  - view_component = 'app_characteristics_form'
  - if lookup_context.template_exists?(view_component, 'transit_assets', true)
    = render :partial => "transit_assets/#{view_component}", :locals => {:f => f}

  = f.button :submit, :class => 'btn btn-primary'