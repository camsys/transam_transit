= render :layout => "update_event_form" do |f|

  = hidden_field_tag :causal_asset_event_name, @causal_asset_event_name
  = hidden_field_tag :causal_asset_event_id, @causal_asset_event_id
  .row
    .col-xs-6
      = f.input :event_date, :label => 'Date of Disposition', :wrapper => :vertical_append do
        = f.input_field :event_date, :as => :string, :class => 'form-control datepicker', :data => {'behavior' => 'datepicker'}, :value => format_as_date(f.object.event_date)
        %span.input-group-addon
          %i.fa.fa-calendar
    .col-xs-6
      = f.association :disposition_type, :label => "Disposition Type", :include_blank => false

  .row.transfer
    .col-xs-6
      =  f.association :organization, collection: Organization.all(), :label => "Transfer Organization"
  .row
    - if @asset.asset_type.class_name == "Vehicle" || @asset.asset_type.class_name == "SupportVehicle"
      .col-xs-6
        = f.input :sales_proceeds, :wrapper => :vertical_prepend, :label => "Sales Proceeds" do
          %span.input-group-addon
            %i.fa.fa-usd
          = f.input :sales_proceeds, :class => 'form-control', :input_html => { :min => 0 }, :label => false

      .col-xs-6
        = f.input :mileage_at_disposition, :as => :integer, :label => "Mileage at disposition", :input_html => { :min => 0 }, :input_html => { :value => @asset.reported_mileage }, :required => true
    - else
      .col-xs-12
        = f.input :sales_proceeds, :wrapper => :vertical_prepend, :label => "Funds Received" do
          %span.input-group-addon
            %i.fa.fa-usd
          = f.input :sales_proceeds, :class => 'form-control', :input_html => { :min => 0 }, :label => false

  = f.input :comments, :input_html => { :rows => 6 }, :placeholder => "Enter any additional comments..."
  .form-group
    = f.button :submit, "Record disposition", :class => 'btn btn-primary'

= render 'disposition_form_scripts'


:javascript

  $(".transfer").hide();

  $('#asset_event_disposition_type_id').change(function() {
    asset_event_organization_id.value="";
    if(asset_event_disposition_type_id.value == 2) {
      $(".transfer").show();
    } else {
      $(".transfer").hide();
    }
  });

  var is_transferred = "#{@transferred}";
  if(is_transferred){
    asset_event_disposition_type_id.value = 2
    $(".transfer").show();
  };